<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js"
      integrity="sha512-n/4gHW3atM3QqRcbCn6ewmpxcLAHGaDjpEBu4xZd47N0W2oQ+6q7oc3PXstrJYXcbNU1OHdQ1T7pAP+gi5Yu8g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div id="cntLoginRegister" class="row align-items-center g-3">
      <div class="col-auto">
        <!-- <label class="visually-hidden" for="inputUserName">User Name</label> -->
        <input
          type="text"
          class="form-control"
          id="inputUserName"
          placeholder="User Name:"
          value="aaa"
        />
      </div>
      <div class="col-auto">
        <!-- <label class="visually-hidden" for="inputPassword">Password</label> -->
        <input
          type="password"
          class="form-control"
          id="inputPassword"
          placeholder="Password:"
          value="123456"
        />
      </div>
      <div class="col-auto">
        <button id="btnLoginRegister" type="button" class="btn btn-primary">
          Login / Register
        </button>
      </div>
    </div>
    

    <div id="cntLogined" class="row align-items-center g-3">
      <div class="col-auto">
        <label>Welcome</label>
      </div>
      <div class="col-auto">
        <label id="lblUserName"></label>
      </div>
      <div class="col-auto">
        <button id="btnShare" type="button" class="btn btn-primary">
          Share a movie
        </button>
      </div>
      <div class="col-auto">
        <button id="btnLogout" type="button" class="btn btn-primary">
          Logout
        </button>
      </div>
    </div>
  </body>
</html>
<script>

  // hide div after logined
  $("#cntLogined").hide();

  $("#btnLoginRegister").click(function () {
    
    loginOrRegister();
  });

  $("#btnLogout").click(function () {
    $("#cntLoginRegister").show();
    $("#cntLogined").hide();
    
  });

async function loginOrRegister() {
  // url
  const baseUrl = window.location.origin
  const rowData = { 
    user_name: $("#inputUserName").val(), 
    password: $("#inputPassword").val()
  }

  try {
    result = await $.ajax({
      url: baseUrl + `/auth/login-register`,
      type: 'POST',
      dataType: 'json',
      data: rowData
    });

    window.sessionStorage.setItem('access_token', result.access_token);
    // alert(window.sessionStorage.getItem('access_token'))

    $("#cntLoginRegister").hide();
    $("#cntLogined").show();
    $("#lblUserName").html(result.user_name);
  } catch (error) {
    console.error(error);
  }
}

function afterLogin() {

}
</script>
